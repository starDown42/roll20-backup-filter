<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>6000자 줄바꿈 기준 분할</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        .result-box {
            margin-bottom: 20px;
        }
        button {
            padding: 6px 12px;
            cursor: pointer;
        }

        span {
            margin-left: 5px;
        }
        
    </style>
</head>
<body>

<h3>원본 텍스트 입력</h3>
<textarea id="sourceText" rows="10" placeholder="여기에 텍스트를 입력해 주십시오."></textarea>
<button onclick="splitText()">분할 실행</button>
<span id="sourceTextCnt"></span>

<hr>

<h3>분할 결과</h3>
<div id="results"></div>

<script>
function splitText() {
    const text = document.getElementById("sourceText").value;
    const maxLength = 3000;
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    const textCnt = document.getElementById("sourceTextCnt");
    textCnt.innerHTML = text.length;

    let start = 0;

    while (start < text.length) {
        if (start + maxLength >= text.length) {
            createResultBox(text.slice(start));
            break;
        }

        const target = start + maxLength;

        const before = text.lastIndexOf("\n", target);
        const after = text.indexOf("\n", target);

        let splitPoint;

        if (before === -1 && after === -1) {
            splitPoint = target;
        } else if (before === -1) {
            splitPoint = after + 1;
        } else if (after === -1) {
            splitPoint = before + 1;
        } else {
            splitPoint = (target - before <= after - target)
                ? before + 1
                : after + 1;
        }

        createResultBox(text.slice(start, splitPoint));
        start = splitPoint;
    }
}

function createResultBox(content) {
    const wrapper = document.createElement("div");
    wrapper.className = "result-box";

    const textarea = document.createElement("textarea");
    textarea.rows = 6;
    textarea.readOnly = true;
    textarea.value = content;

    const button = document.createElement("button");
    button.textContent = "복사";
    button.onclick = () => {
        textarea.select();
        document.execCommand("copy");
    };

    const span = document.createElement("span");
    span.textContent = content.length + "자";

    wrapper.appendChild(textarea);
    wrapper.appendChild(button);
    wrapper.appendChild(span);

    document.getElementById("results").appendChild(wrapper);
}
</script>

</body>
</html>